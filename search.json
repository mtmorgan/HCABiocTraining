[{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/a-intro-to-r.html","id":"essential-r","dir":"Articles","previous_headings":"","what":"Essential R","title":"A. Introduction to R","text":"simple calculator ‘Vectors’ building blocks Variables, missing values ‘factors’ Data structures coordinate related vectors – data.frame Functions   ‘Vectorized’ operations, e.g., element-wise addition without explicit ‘’ loop  Write functions Iterate, usually lapply() although () available","code":"1 + 1 ## [1] 2 c(1, 2, 3) ## [1] 1 2 3 c(\"January\", \"February\", \"March\") ## [1] \"January\"  \"February\" \"March\" c(TRUE, FALSE) ## [1]  TRUE FALSE age <- c(27, NA, 32, 29) gender <- factor(     c(\"Female\", \"Male\", \"Non-binary\", NA),     levels = c(\"Female\", \"Male\", \"Non-binary\") ) df <- data.frame(     age = c(27, NA, 32, 29),     gender = gender ) df ##   age     gender ## 1  27     Female ## 2  NA       Male ## 3  32 Non-binary ## 4  29       <NA> rnorm(5)        # 5 random normal deviates ## [1] -0.9804657 -1.0160537 -0.1154069 -1.3163632  0.5317101 x <- rnorm(100) # 100 random normal deviates hist(x)         # histogram, approximately normal plot(density(x)) # a little more sophisticated? y <- x + rnorm(100) plot(y ~ x) fit <- lm(y ~ x) fit         # an R 'object' containing information about the ##  ## Call: ## lm(formula = y ~ x) ##  ## Coefficients: ## (Intercept)            x   ##     -0.1358       1.0283             # regression of y on x abline(fit) # plot points and fitted regression line anova(fit)  # statistical summary of linear regression ## Analysis of Variance Table ##  ## Response: y ##           Df  Sum Sq Mean Sq F value    Pr(>F)     ## x          1 106.904 106.904  109.74 < 2.2e-16 *** ## Residuals 98  95.466   0.974                       ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 hello <- function(who) {     paste(\"hello\", who, \"with\", nchar(who), \"letters in your name\") } hello(\"Martin\") ## [1] \"hello Martin with 6 letters in your name\" names <- c(\"Martin\", \"Thomas\") lapply(names, hello) ## [[1]] ## [1] \"hello Martin with 6 letters in your name\" ##  ## [[2]] ## [1] \"hello Thomas with 6 letters in your name\""},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/a-intro-to-r.html","id":"packages","dir":"Articles","previous_headings":"","what":"Packages","title":"A. Introduction to R","text":"Extend functionality base R. Can part ‘base’ distribution… …contributed, e.g., dplyr introduce ‘tidyverse’ ‘tibble’ like ‘data.frame’, user-friendly tidyverse makes use ‘pipes’ |>. pipe takes left-hand side pass right-hand side. Key dplyr ‘verbs’ can piped together: filter() (rows), select() (columns), mutate() (change values), group_by() (operate groups rows) Another example: ggplot2 visualization","code":"## iterate over the numbers 1 through 8, 'sleeping' for 1 second ## each. Takes about 8 seconds... system.time({     lapply(1:8, function(i) Sys.sleep(1)) }) ##    user  system elapsed  ##   0.002   0.000   8.011  ## sleep in parallel -- takes only 2 seconds library(parallel) cl <- makeCluster(4) # cluster of 4 workers system.time({     parLapply(cl, 1:8, function(i) Sys.sleep(1)) }) ##    user  system elapsed  ##   0.003   0.000   2.090 library(dplyr) tbl <- tibble(     x = rnorm(100),     y = x + rnorm(100) )  ## e.g., only displays the first 10 rows tbl ## # A tibble: 100 × 2 ##          x      y ##      <dbl>  <dbl> ##  1  2.13    3.55  ##  2  0.0779 -1.14  ##  3  1.25    1.22  ##  4  0.847   1.28  ##  5 -1.08   -2.38  ##  6  0.151  -0.736 ##  7  1.07    0.828 ##  8 -0.572  -1.86  ##  9 -0.836  -1.10  ## 10  0.218  -0.842 ## # … with 90 more rows tbl |>     ## e.g., just rows with non-negative values of x and y     filter(x > 0, y > 0) |>     ## add a column     mutate(distance_from_origin = sqrt(x^2 + y^2)) ## # A tibble: 31 × 3 ##        x      y distance_from_origin ##    <dbl>  <dbl>                <dbl> ##  1 2.13  3.55                  4.14  ##  2 1.25  1.22                  1.75  ##  3 0.847 1.28                  1.54  ##  4 1.07  0.828                 1.36  ##  5 1.15  0.601                 1.30  ##  6 0.247 0.122                 0.275 ##  7 1.38  1.13                  1.79  ##  8 0.598 0.891                 1.07  ##  9 0.179 0.888                 0.906 ## 10 0.279 0.0848                0.292 ## # … with 21 more rows library(ggplot2) ggplot(tbl) +     aes(x, y) +                # use 'x' and 'y' columns for plotting...     geom_point() +             # ...plot points...     geom_smooth(method = \"lm\") # ...linear regresion ## `geom_smooth()` using formula = 'y ~ x'"},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/a-intro-to-r.html","id":"where-do-packages-come-from","dir":"Articles","previous_headings":"Packages","what":"Where do Packages Come From?","title":"A. Introduction to R","text":"CRAN: Comprehensive R Archive Network. 18,000 packages. help CRAN Task Views identifying relevant packages. Bioconductor: 2100 packages relevant high-throughput genomic analysis. Vignettes important part Bioconductor packages. Install packages per R installation, using BiocManager::install(<package-name>) (CRAN Bioconductor) GitHub? Packages haven’t checked formal system, may incomplete code, documentation, dependencies packages, etc. Authors may yet committed long-term maintenance package.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/a-intro-to-r.html","id":"help-vignettes","dir":"Articles","previous_headings":"","what":"Help & Vignettes","title":"A. Introduction to R","text":"Help pages, e.g., ?lm Vignettes, e.g., Google, StackOverflow, etc…","code":"vignette(package = \"ggplot2\") vignette(\"ggplot2-specs\", \"ggplot2\")"},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/b-hca-data-access.html","id":"data-transformations","dir":"Articles","previous_headings":"","what":"Data Transformations","title":"B. Accessing HCA Data from R / Bioconductor","text":"FASTQ files DNA sequences quality scores large Processed e.g., CellRanger software Quality control, summary count matrix () Count matrix Usually genes (rows) x cells (columns) Can large (e.g., 30,000 genes x 50,000 cells) Usually sparse, e.g., 95% cells ‘0’. Still large enough require decent amount computing power, e.g., 32 GB RAM, 8 CPU steps. Common formats CSV file – lots zero’s wasteful space. ‘Matrix Market’ sparse matrix files, e.g., tuples <row, column, count> non-zero values. HDF5, e.g., .loom .h5ad (anndata). Representation R -memory sparse matrices: dgCMatrix class Matrix package -disk representation via Bioconductor’s DelayedArray / HDF5Array. Counts & annotations CSV Matrix Market files store just counts; usually annotations columns (e.g., sample cell come ?) stored separately. HDF5 file formats coordinate row column annotations count data. R software tries offer coordinated representation counts metadata, e.g., Bioconductor’s SingleCellExperiment.","code":""},{"path":[]},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/b-hca-data-access.html","id":"human-cell-atlas","dir":"Articles","previous_headings":"Data Discovery","what":"Human Cell Atlas","title":"B. Accessing HCA Data from R / Bioconductor","text":"Data portal  ’s available? Project & sample annotations HCA-funded projects FASTQ files ‘Legacy’ .loom files 50 experiments Ad hoc count matrix data – mostly CSV Matrix Market files – easy download, … Count matrix data uncertain provenance (computed?). Often considerable work required create usable data, e.g., hcaCaseStudies","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/b-hca-data-access.html","id":"cellxgene","dir":"Articles","previous_headings":"Data Discovery","what":"CellXGene","title":"B. Accessing HCA Data from R / Bioconductor","text":"Data Portal  ’s available? Collections datasets contributed single-cell community, overlap data sets HCA Data Portal. FASTQ files .h5ad-summarized count data cell metadata, well reduced-dimension (e.g., UMAP) representations Summarized count files provided contributor / individual lab, uncertain provenance Easy download count matrix, e.g., .h5ad (anndata) format Easy visualize (!)","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/b-hca-data-access.html","id":"programatic-discovery","dir":"Articles","previous_headings":"","what":"Programatic Discovery","title":"B. Accessing HCA Data from R / Bioconductor","text":"use R script Data Portals exist? Easily reproducible Flexible exploration rich & complex data Direct integration Bioconductor single-cell workflows","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/b-hca-data-access.html","id":"human-cell-atlas-1","dir":"Articles","previous_headings":"Programatic Discovery","what":"Human Cell Atlas","title":"B. Accessing HCA Data from R / Bioconductor","text":"See ExploratingHCACxG workshop HCA data retrieval retrieving legacy .loom files. See hcaCaseStudies examples processing CSV Matrix Market files.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/b-hca-data-access.html","id":"cellxgene-1","dir":"Articles","previous_headings":"Programatic Discovery","what":"CellXGene","title":"B. Accessing HCA Data from R / Bioconductor","text":"Load [cellxgenedp][] package Retrieve current database, use ‘tidy’ functionality mimic graphical selection web browser – 10x 3’ v3 (EFO:0009922) assay, Affrican American ethnicity, female gender) ‘Join’ selected datasets files identify files associated datasets. Select first ‘CXG’ file available subset data; reproducibility retrieve dataset id… … set ; helper function cxg_dataset() provides summary dataset. Visualize ‘CXG’ file browser… …select ‘H5AD’ file associated dataset download subsequent processing R downloaded file cached, next time access fast.","code":"library(cellxgenedp) db <- db() african_american_female <-     datasets(db) |>     dplyr::filter(         facets_filter(assay, \"ontology_term_id\", \"EFO:0009922\"),         facets_filter(self_reported_ethnicity, \"label\", \"African American\"),         facets_filter(sex, \"label\", \"female\")     ) african_american_female ## # A tibble: 21 × 28 ##    dataset_id     colle…¹ donor…² assay  cell_…³ cell_…⁴ datas…⁵ devel…⁶ disease ##    <chr>          <chr>   <list>  <list>   <int> <list>  <chr>   <list>  <list>  ##  1 de985818-285f… c9706a… <list>  <list>   31696 <list>  https:… <list>  <list>  ##  2 f72958f5-7f42… 2f75d2… <list>  <list>  982538 <list>  https:… <list>  <list>  ##  3 bc2a7b3d-f04e… b9fc3d… <list>  <list>  109995 <list>  https:… <list>  <list>  ##  4 96a3f64b-0ee9… b9fc3d… <list>  <list>  239696 <list>  https:… <list>  <list>  ##  5 d9b4bc69-ed90… b9fc3d… <list>  <list>   20000 <list>  https:… <list>  <list>  ##  6 59b69042-47c2… b9fc3d… <list>  <list>   49139 <list>  https:… <list>  <list>  ##  7 e763ed0d-0e5a… b9fc3d… <list>  <list>    7274 <list>  https:… <list>  <list>  ##  8 db0752b9-f20e… b9fc3d… <list>  <list>   55348 <list>  https:… <list>  <list>  ##  9 e9175006-8978… 62e8f0… <list>  <list>   14072 <list>  https:… <list>  <list>  ## 10 d224c8e0-c28e… 62e8f0… <list>  <list>    8030 <list>  https:… <list>  <list>  ## # … with 11 more rows, 19 more variables: is_primary_data <chr>, ## #   is_valid <lgl>, linked_genesets <lgl>, mean_genes_per_cell <dbl>, ## #   name <chr>, organism <list>, processing_status <list>, published <lgl>, ## #   revision <int>, schema_version <chr>, self_reported_ethnicity <list>, ## #   sex <list>, suspension_type <list>, tissue <list>, tombstone <lgl>, ## #   created_at <date>, published_at <date>, revised_at <date>, ## #   updated_at <date>, and abbreviated variable names ¹​collection_id, … selected_files <-     left_join(         african_american_female |> select(dataset_id),         files(db),         by = \"dataset_id\"     ) selected_files ## # A tibble: 63 × 8 ##    dataset_id       file_id filen…¹ filet…² s3_uri user_…³ created_at updated_at ##    <chr>            <chr>   <chr>   <chr>   <chr>  <lgl>   <date>     <date>     ##  1 de985818-285f-4… 15e9d9… local.… H5AD    s3://… TRUE    2022-10-21 2022-10-21 ##  2 de985818-285f-4… 0d3974… explor… CXG     s3://… TRUE    2022-10-21 2022-10-21 ##  3 de985818-285f-4… e254f9… local.… RDS     s3://… TRUE    2022-10-21 2022-10-21 ##  4 f72958f5-7f42-4… 59bd46… local.… RDS     s3://… TRUE    2022-10-18 2022-10-18 ##  5 f72958f5-7f42-4… 3a2467… explor… CXG     s3://… TRUE    2022-10-18 2022-10-18 ##  6 f72958f5-7f42-4… d9f9d0… local.… H5AD    s3://… TRUE    2022-10-18 2022-10-18 ##  7 bc2a7b3d-f04e-4… f6d9f2… local.… H5AD    s3://… TRUE    2022-10-18 2022-10-18 ##  8 bc2a7b3d-f04e-4… 46de9c… explor… CXG     s3://… TRUE    2022-10-18 2022-10-18 ##  9 bc2a7b3d-f04e-4… 5331f2… local.… RDS     s3://… TRUE    2022-10-18 2022-10-18 ## 10 96a3f64b-0ee9-4… b77452… local.… H5AD    s3://… TRUE    2022-10-18 2022-10-18 ## # … with 53 more rows, and abbreviated variable names ¹​filename, ²​filetype, ## #   ³​user_submitted selected_files |>     dplyr::filter(filetype == \"CXG\") |>     dplyr::slice(1) |>     pull(dataset_id) ## [1] \"de985818-285f-4f59-9dbd-d74968fddba3\" ## \"de985818-285f-4f59-9dbd-d74968fddba3\" dataset <- \"de985818-285f-4f59-9dbd-d74968fddba3\" cxg_dataset(dataset) ## title: A single-cell atlas of the healthy breast tissues reveals ##     clinically relevant clusters of breast epithelial cells ## description: Single-cell RNA sequencing (scRNA-seq) is an evolving ##     technology used to elucidate the cellular architecture of adult ##     organs. Previous scRNA-seq on breast tissue utilized reduction ##     mammoplasty samples, which are often histologically abnormal. We ##     report a rapid tissue collection/processing protocol to perform ##     scRNA-seq of breast biopsies of healthy women and identify 23 ##     breast epithelial cell clusters. Putative cell-of-origin signatures ##     derived from these clusters are applied to analyze transcriptomes ##     of ~3,000 breast cancers. Gene signatures derived from mature ##     luminal cell clusters are enriched in ~68% of breast cancers, ##     whereas a signature from a luminal progenitor cluster is enriched ##     in ~20% of breast cancers. Overexpression of luminal progenitor ##     cluster-derived signatures in HER2+, but not in other subtypes, is ##     associated with unfavorable outcome. We identify TBX3 and PDK4 as ##     genes co-expressed with estrogen receptor (ER) in the normal ##     breasts, and their expression analyses in >550 breast cancers ##     enable prognostically relevant subclassification of ER+ breast ##     cancers. ## authors: Bhat-Nakshatri, Poornima; Gao, Hongyu; Sheng, Liu; McGuire, ##     Patrick C.; Xuei, Xiaoling; Wan, Jun; Liu, Yunlong; Althouse, ##     Sandra K.; Colter, Austyn; Sandusky, George; Storniolo, Anna Maria; ##     Nakshatri, Harikrishna ## journal: Cell Reports Medicine ## assays: 10x 3' v2; 10x 3' v3 ## organism: Homo sapiens ## ethnicity: African American; Chinese; European selected_files |>     dplyr::filter(filetype == \"CXG\", dataset_id == dataset) |>     datasets_visualize() h5ad_file <-     selected_files |>     dplyr::filter(filetype == \"H5AD\", dataset_id == dataset) |>     files_download(dry.run = FALSE)"},{"path":[]},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/b-hca-data-access.html","id":"singlecellexperiment","dir":"Articles","previous_headings":"Representation in R","what":"SingleCellExperiment","title":"B. Accessing HCA Data from R / Bioconductor","text":"Easy work reduced-dimension data…  …also counts data, e.g., distribution reads per cell  …remove genes non-zero counts ’s also easy find information samples included study, e.g., individual donors, ethnicty, family history breast cancer (specific information available depends data submitted original investigator). Glancing table, see little replication serious confounding factors.","code":"h5ad <- read_h5ad_as_sce(h5ad_file) h5ad ## class: SingleCellExperiment  ## dim: 33234 31696  ## metadata(3): default_embedding schema_version title ## assays(1): X ## rownames(33234): ENSG00000243485 ENSG00000237613 ... ENSG00000277475 ##   ENSG00000268674 ## rowData names(4): feature_is_filtered feature_name feature_reference ##   feature_biotype ## colnames(31696): CMGpool_AAACCCAAGGACAACC CMGpool_AAACCCACAATCTCTT ... ##   K109064_TTTGTTGGTTGCATCA K109064_TTTGTTGGTTGGACCC ## colData names(34): donor_id self_reported_ethnicity_ontology_term_id ##   ... self_reported_ethnicity development_stage ## reducedDimNames(3): X_pca X_tsne X_umap ## mainExpName: NULL ## altExpNames(0):  umap <- as_tibble(reducedDim(h5ad, \"X_umap\")) ## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if ## `.name_repair` is omitted as of tibble 2.0.0. ## ℹ Using compatibility `.name_repair`.  ggplot(umap) +     aes(x = V1, y = V2, color = h5ad$cell_type) +     geom_point(pch = \".\") reads_per_cell <-     h5ad |>     ## retrieve the matrix of gene x cell counts     assay() |>     ## calculate the column sums, i.e., reads mapped to each cell     colSums()  hist(log10(reads_per_cell)) reads_per_gene <-     h5ad |>     assay() |>     rowSums()  table(reads_per_gene != 0) ##  ## FALSE  TRUE  ## 10499 22735 h5ad[reads_per_gene != 0,] ## class: SingleCellExperiment  ## dim: 22735 31696  ## metadata(3): default_embedding schema_version title ## assays(1): X ## rownames(22735): ENSG00000238009 ENSG00000237491 ... ENSG00000276345 ##   ENSG00000271254 ## rowData names(4): feature_is_filtered feature_name feature_reference ##   feature_biotype ## colnames(31696): CMGpool_AAACCCAAGGACAACC CMGpool_AAACCCACAATCTCTT ... ##   K109064_TTTGTTGGTTGCATCA K109064_TTTGTTGGTTGGACCC ## colData names(34): donor_id self_reported_ethnicity_ontology_term_id ##   ... self_reported_ethnicity development_stage ## reducedDimNames(3): X_pca X_tsne X_umap ## mainExpName: NULL ## altExpNames(0): SingleCellExperiment::colData(h5ad) |>     as_tibble() |>     dplyr::count(         donor_id, self_reported_ethnicity, family_history_breast_cancer     ) ## # A tibble: 7 × 4 ##   donor_id                 self_reported_ethnicity family_history_breast…¹     n ##   <fct>                    <fct>                   <fct>                   <int> ## 1 D1                       European                unknown                  2303 ## 2 D2                       European                True                      864 ## 3 D3                       African American        True                     2517 ## 4 D4                       European                False                    1771 ## 5 D5                       European                True                     2244 ## 6 D11                      Chinese                 True                     7454 ## 7 pooled [D9,D7,D8,D10,D6] European                pooled [unknown,False,… 14543 ## # … with abbreviated variable name ¹​family_history_breast_cancer"},{"path":[]},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/c-sc-analysis.html","id":"exploring-pre-computed-data","dir":"Articles","previous_headings":"","what":"Exploring Pre-computed Data","title":"C. Single-Cell Sequence Analysis","text":"illustrate steps data CELLxGENE retrieved previous article. data need proceed simple count matrix produced Cell Ranger (etc.) careful quality control, normalization, data integration / batch coorrection, etc., illustrated subsequent section.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/c-sc-analysis.html","id":"data-retrieval","dir":"Articles","previous_headings":"Exploring Pre-computed Data","what":"Data retrieval","title":"C. Single-Cell Sequence Analysis","text":"following abbreviated version steps illustrated previous article.","code":"## use a known dataset ID, discovered previously.. dataset <- \"de985818-285f-4f59-9dbd-d74968fddba3\" cxg_dataset(dataset) ## title: A single-cell atlas of the healthy breast tissues reveals ##     clinically relevant clusters of breast epithelial cells ## description: Single-cell RNA sequencing (scRNA-seq) is an evolving ##     technology used to elucidate the cellular architecture of adult ##     organs. Previous scRNA-seq on breast tissue utilized reduction ##     mammoplasty samples, which are often histologically abnormal. We ##     report a rapid tissue collection/processing protocol to perform ##     scRNA-seq of breast biopsies of healthy women and identify 23 ##     breast epithelial cell clusters. Putative cell-of-origin signatures ##     derived from these clusters are applied to analyze transcriptomes ##     of ~3,000 breast cancers. Gene signatures derived from mature ##     luminal cell clusters are enriched in ~68% of breast cancers, ##     whereas a signature from a luminal progenitor cluster is enriched ##     in ~20% of breast cancers. Overexpression of luminal progenitor ##     cluster-derived signatures in HER2+, but not in other subtypes, is ##     associated with unfavorable outcome. We identify TBX3 and PDK4 as ##     genes co-expressed with estrogen receptor (ER) in the normal ##     breasts, and their expression analyses in >550 breast cancers ##     enable prognostically relevant subclassification of ER+ breast ##     cancers. ## authors: Bhat-Nakshatri, Poornima; Gao, Hongyu; Sheng, Liu; McGuire, ##     Patrick C.; Xuei, Xiaoling; Wan, Jun; Liu, Yunlong; Althouse, ##     Sandra K.; Colter, Austyn; Sandusky, George; Storniolo, Anna Maria; ##     Nakshatri, Harikrishna ## journal: Cell Reports Medicine ## assays: 10x 3' v2; 10x 3' v3 ## organism: Homo sapiens ## ethnicity: African American; Chinese; European  ## download (or retieve from the local cache) the file h5ad_file <-     files() |>     dplyr::filter(filetype == \"H5AD\", dataset_id == dataset) |>     files_download(dry.run = FALSE)  ## import into R as a SingleCellExperiment h5ad <- read_h5ad_as_sce(h5ad_file)  h5ad ## class: SingleCellExperiment  ## dim: 33234 31696  ## metadata(3): default_embedding schema_version title ## assays(1): X ## rownames(33234): ENSG00000243485 ENSG00000237613 ... ENSG00000277475 ##   ENSG00000268674 ## rowData names(4): feature_is_filtered feature_name feature_reference ##   feature_biotype ## colnames(31696): CMGpool_AAACCCAAGGACAACC CMGpool_AAACCCACAATCTCTT ... ##   K109064_TTTGTTGGTTGCATCA K109064_TTTGTTGGTTGGACCC ## colData names(34): donor_id self_reported_ethnicity_ontology_term_id ##   ... self_reported_ethnicity development_stage ## reducedDimNames(3): X_pca X_tsne X_umap ## mainExpName: NULL ## altExpNames(0):"},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/c-sc-analysis.html","id":"visualization","dir":"Articles","previous_headings":"Exploring Pre-computed Data","what":"Visualization","title":"C. Single-Cell Sequence Analysis","text":"previous article created static visualization ‘UMAP’ reduced dimension representation. First load ggplot2 create tibble containing information UMAP, well cell (column) annotations Visualize two-dimensional UMAP summary, coloring cell type  plotly package provides convenient way make interactive plot suprisingly straight-forward (admittedly advanced) helper function uses shiny allows us write application select data interested … check !","code":"library(ggplot2) umap <-     as_tibble(reducedDim(h5ad, \"X_umap\")) |>     bind_cols(         cell_type = h5ad$cell_type,         donor_id = h5ad$donor_id,         self_reported_ethnicity = h5ad$self_reported_ethnicity,         colname = colnames(h5ad) # unique identifier     ) ## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if ## `.name_repair` is omitted as of tibble 2.0.0. ## ℹ Using compatibility `.name_repair`. ggplot(umap) +     aes(x = V1, y = V2, color = cell_type) +     geom_point(pch = \".\") library(plotly)  plot_ly(     umap,     x = ~ V1, y =  ~ V2, color = ~ cell_type,     type = \"scatter\", mode = \"markers\", opacity = .5,     marker = list(symbol = \"circle-open\", line = list(width = 1)) ) result <- tutorial_cell_viewer(umap) # select some cells of interest result ## subset the SingleCellExperiment to just those cells h5ad[, result$colname]"},{"path":[]},{"path":[]},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/c-sc-analysis.html","id":"essential-steps","dir":"Articles","previous_headings":"","what":"Essential Steps","title":"C. Single-Cell Sequence Analysis","text":"Based Orchestrating Single-Cell Analysis Bioconductor.","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://mtmorgan.github.io/HCABiocTraining/articles/d-directions.html","id":"spatial-transcriptomics","dir":"Articles","previous_headings":"Directions","what":"Spatial Transcriptomics","title":"D. Prospects for Spatial and Extended Analysis","text":"Orchestrating Spatially-Resolved Transcriptomics Analysis Bioconductor","code":""},{"path":[]},{"path":[]},{"path":"https://mtmorgan.github.io/HCABiocTraining/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Martin Morgan. Author, maintainer.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Morgan M (2022). HCABiocTraining: Introduction Human Cell Atlas Data Access & Analysis R / Bioconductor. R package version 0.0.4, https://mtmorgan.github.io/HCABiocTraining.","code":"@Manual{,   title = {HCABiocTraining: Introduction to Human Cell Atlas Data Access & Analysis in R / Bioconductor},   author = {Martin Morgan},   year = {2022},   note = {R package version 0.0.4},   url = {https://mtmorgan.github.io/HCABiocTraining}, }"},{"path":"https://mtmorgan.github.io/HCABiocTraining/index.html","id":"hcabioctraining","dir":"","previous_headings":"","what":"Introduction to Human Cell Atlas Data Access & Analysis in R /\n    Bioconductor","title":"Introduction to Human Cell Atlas Data Access & Analysis in R /\n    Bioconductor","text":"HCABiocTraining introduction Human Cell Atlas data retrieval analysis R / Bioconductor. focus single-cell RNA-seq data. wide range material covered, basic R advanced data analysis steps outlined ‘Orchestrating Single-Cell Analysis Bioconductor’ (OSCA). treatment superficial, hope unlocks opportunities reproducible, sophisticated analysis.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Introduction to Human Cell Atlas Data Access & Analysis in R /\n    Bioconductor","text":"Install necessary software GitHub :","code":"if (!\"BiocManager\" %in% rownames(installed.packages()))     install.packages(\"BiocManager\", repos = \"https://cran.r-project.org\") BiocManager::install(\"mtmorgan/HCABiocTraining\")"},{"path":"https://mtmorgan.github.io/HCABiocTraining/index.html","id":"articles","dir":"","previous_headings":"","what":"Articles","title":"Introduction to Human Cell Atlas Data Access & Analysis in R /\n    Bioconductor","text":"articles repository cover four main topics Introduction R. Scripting, core functions, contributed packages. HCA Data Access. Using hca cellxgenedp packages data retrieval. R Bioconductor Analysis Single-Cell Expression Data. Introduction key resources available analysis single-cell expression data. Seurat. SingleCellExperiment ‘Orchestrating Single-Cell Analysis Bioconductor’ (OSCA) Prospects spatial extended analysis.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/cxg_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize CxG Information About a Dataset — cxg_dataset","title":"Summarize CxG Information About a Dataset — cxg_dataset","text":"Summarize CxG Information Dataset","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/cxg_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize CxG Information About a Dataset — cxg_dataset","text":"","code":"cxg_dataset(dataset_id)  # S3 method for cxg_dataset print(x, ...)"},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/cxg_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize CxG Information About a Dataset — cxg_dataset","text":"dataset_id character(1) dataset identifier, returned , e.g., datasets(). x cxg_dataset object resulting call cxg_dataset(). ... Additional arguments (print.cxg_dataset()); ignored.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/cxg_dataset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize CxG Information About a Dataset — cxg_dataset","text":"","code":"dataset <- \"de985818-285f-4f59-9dbd-d74968fddba3\" ds <- cxg_dataset(dataset) ds #> title: A single-cell atlas of the healthy breast tissues reveals #>     clinically relevant clusters of breast epithelial cells #> description: Single-cell RNA sequencing (scRNA-seq) is an evolving #>     technology used to elucidate the cellular architecture of adult #>     organs. Previous scRNA-seq on breast tissue utilized reduction #>     mammoplasty samples, which are often histologically abnormal. We #>     report a rapid tissue collection/processing protocol to perform #>     scRNA-seq of breast biopsies of healthy women and identify 23 #>     breast epithelial cell clusters. Putative cell-of-origin signatures #>     derived from these clusters are applied to analyze transcriptomes #>     of ~3,000 breast cancers. Gene signatures derived from mature #>     luminal cell clusters are enriched in ~68% of breast cancers, #>     whereas a signature from a luminal progenitor cluster is enriched #>     in ~20% of breast cancers. Overexpression of luminal progenitor #>     cluster-derived signatures in HER2+, but not in other subtypes, is #>     associated with unfavorable outcome. We identify TBX3 and PDK4 as #>     genes co-expressed with estrogen receptor (ER) in the normal #>     breasts, and their expression analyses in >550 breast cancers #>     enable prognostically relevant subclassification of ER+ breast #>     cancers. #> authors: Bhat-Nakshatri, Poornima; Gao, Hongyu; Sheng, Liu; McGuire, #>     Patrick C.; Xuei, Xiaoling; Wan, Jun; Liu, Yunlong; Althouse, #>     Sandra K.; Colter, Austyn; Sandusky, George; Storniolo, Anna Maria; #>     Nakshatri, Harikrishna #> journal: Cell Reports Medicine #> assays: 10x 3' v2; 10x 3' v3 #> organism: Homo sapiens #> ethnicity: African American; Chinese; European"},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/read_h5ad.html","id":null,"dir":"Reference","previous_headings":"","what":"Read 'h5ad' Files as R / Bioconductor Objects — read_h5ad_as_sce","title":"Read 'h5ad' Files as R / Bioconductor Objects — read_h5ad_as_sce","text":"read_h5ad_as_sce() uses Python h5ad module R 'anndata' package import .h5ad objects R / Bioconductor 'SingleCellExperiment'.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/read_h5ad.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read 'h5ad' Files as R / Bioconductor Objects — read_h5ad_as_sce","text":"","code":"read_h5ad_as_sce(h5ad_file_path)"},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/read_h5ad.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read 'h5ad' Files as R / Bioconductor Objects — read_h5ad_as_sce","text":"h5ad_file_path character(1) path .h5ad file.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/read_h5ad.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read 'h5ad' Files as R / Bioconductor Objects — read_h5ad_as_sce","text":"read_h5ad_as_sce() returns R / Bioconductor SingleCellExperiment object. assay data X (sparse) matrix named 'X' h5ad file.","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/tutorial_cell_viewer.html","id":null,"dir":"Reference","previous_headings":"","what":"Interactively Visualize and Subset UMAPs — tutorial_cell_viewer","title":"Interactively Visualize and Subset UMAPs — tutorial_cell_viewer","text":"Interactively Visualize Subset UMAPs","code":""},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/tutorial_cell_viewer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interactively Visualize and Subset UMAPs — tutorial_cell_viewer","text":"","code":"tutorial_cell_viewer(umap)"},{"path":"https://mtmorgan.github.io/HCABiocTraining/reference/tutorial_cell_viewer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interactively Visualize and Subset UMAPs — tutorial_cell_viewer","text":"umap tibble() ","code":""}]
